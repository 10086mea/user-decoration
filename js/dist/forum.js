/*! For license information please see forum.js.LICENSE.txt */
(()=>{var t={946:t=>{var r=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};r.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},r.prototype.update=function(t){this.context.putImageData(t,0,0)},r.prototype.getPixelCount=function(){return this.width*this.height},r.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},r.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var e=function(){};if(e.prototype.getColor=function(t,r){return this.getPalette(t,5,r)[0]},e.prototype.getPalette=function(t,e,n){void 0===e&&(e=10),(void 0===n||1>n)&&(n=10);for(var a,i,s,c,u=new r(t),l=u.getImageData().data,d=u.getPixelCount(),p=[],h=0;d>h;h+=n)i=l[0+(a=4*h)],s=l[a+1],c=l[a+2],l[a+3]>=125&&(i>250&&s>250&&c>250||p.push([i,s,c]));var f=o.quantize(p,e),m=f?f.palette():null;return u.removeCanvas(),m},!n)var n={map:function(t,r){var e={};return r?t.map((function(t,n){return e.index=n,r.call(e,t)})):t.slice()},naturalOrder:function(t,r){return r>t?-1:t>r?1:0},sum:function(t,r){var e={};return t.reduce(r?function(t,n,o){return e.index=o,t+r.call(e,n)}:function(t,r){return t+r},0)},max:function(t,r){return Math.max.apply(null,r?n.map(t,r):t)}};var o=function(){function t(t,r,e){return(t<<2*c)+(r<<c)+e}function r(t){function r(){e.sort(t),n=!0}var e=[],n=!1;return{push:function(t){e.push(t),n=!1},peek:function(t){return n||r(),void 0===t&&(t=e.length-1),e[t]},pop:function(){return n||r(),e.pop()},size:function(){return e.length},map:function(t){return e.map(t)},debug:function(){return n||r(),e}}}function e(t,r,e,n,o,a,i){var s=this;s.r1=t,s.r2=r,s.g1=e,s.g2=n,s.b1=o,s.b2=a,s.histo=i}function o(){this.vboxes=new r((function(t,r){return n.naturalOrder(t.vbox.count()*t.vbox.volume(),r.vbox.count()*r.vbox.volume())}))}function a(r){var e,n,o,a,i=new Array(1<<3*c);return r.forEach((function(r){n=r[0]>>u,o=r[1]>>u,a=r[2]>>u,e=t(n,o,a),i[e]=(i[e]||0)+1})),i}function i(t,r){var n,o,a,i=1e6,s=0,c=1e6,l=0,d=1e6,p=0;return t.forEach((function(t){n=t[0]>>u,o=t[1]>>u,a=t[2]>>u,i>n?i=n:n>s&&(s=n),c>o?c=o:o>l&&(l=o),d>a?d=a:a>p&&(p=a)})),new e(i,s,c,l,d,p,r)}function s(r,e){if(e.count()){var o=e.r2-e.r1+1,a=e.g2-e.g1+1,i=e.b2-e.b1+1,s=n.max([o,a,i]);if(1==e.count())return[e.copy()];var c,u,l,d,p=0,h=[],f=[];if(s==o)for(c=e.r1;c<=e.r2;c++){for(d=0,u=e.g1;u<=e.g2;u++)for(l=e.b1;l<=e.b2;l++)d+=r[t(c,u,l)]||0;p+=d,h[c]=p}else if(s==a)for(c=e.g1;c<=e.g2;c++){for(d=0,u=e.r1;u<=e.r2;u++)for(l=e.b1;l<=e.b2;l++)d+=r[t(u,c,l)]||0;p+=d,h[c]=p}else for(c=e.b1;c<=e.b2;c++){for(d=0,u=e.r1;u<=e.r2;u++)for(l=e.g1;l<=e.g2;l++)d+=r[t(u,l,c)]||0;p+=d,h[c]=p}return h.forEach((function(t,r){f[r]=p-t})),function(t){var r,n,o,a,i,s=t+"1",u=t+"2",l=0;for(c=e[s];c<=e[u];c++)if(h[c]>p/2){for(o=e.copy(),a=e.copy(),r=c-e[s],i=(n=e[u]-c)>=r?Math.min(e[u]-1,~~(c+n/2)):Math.max(e[s],~~(c-1-r/2));!h[i];)i++;for(l=f[i];!l&&h[i-1];)l=f[--i];return o[u]=i,a[s]=o[u]+1,[o,a]}}(s==o?"r":s==a?"g":"b")}}var c=5,u=8-c;return e.prototype={volume:function(t){var r=this;return(!r._volume||t)&&(r._volume=(r.r2-r.r1+1)*(r.g2-r.g1+1)*(r.b2-r.b1+1)),r._volume},count:function(r){var e=this,n=e.histo;if(!e._count_set||r){var o,a,i,s=0;for(o=e.r1;o<=e.r2;o++)for(a=e.g1;a<=e.g2;a++)for(i=e.b1;i<=e.b2;i++)index=t(o,a,i),s+=n[index]||0;e._count=s,e._count_set=!0}return e._count},copy:function(){var t=this;return new e(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(r){var e=this,n=e.histo;if(!e._avg||r){var o,a,i,s,u=0,l=1<<8-c,d=0,p=0,h=0;for(a=e.r1;a<=e.r2;a++)for(i=e.g1;i<=e.g2;i++)for(s=e.b1;s<=e.b2;s++)u+=o=n[t(a,i,s)]||0,d+=o*(a+.5)*l,p+=o*(i+.5)*l,h+=o*(s+.5)*l;e._avg=u?[~~(d/u),~~(p/u),~~(h/u)]:[~~(l*(e.r1+e.r2+1)/2),~~(l*(e.g1+e.g2+1)/2),~~(l*(e.b1+e.b2+1)/2)]}return e._avg},contains:function(t){var r=this,e=t[0]>>u;return gval=t[1]>>u,bval=t[2]>>u,e>=r.r1&&e<=r.r2&&gval>=r.g1&&gval<=r.g2&&bval>=r.b1&&bval<=r.b2}},o.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map((function(t){return t.color}))},size:function(){return this.vboxes.size()},map:function(t){for(var r=this.vboxes,e=0;e<r.size();e++)if(r.peek(e).vbox.contains(t))return r.peek(e).color;return this.nearest(t)},nearest:function(t){for(var r,e,n,o=this.vboxes,a=0;a<o.size();a++)(r>(e=Math.sqrt(Math.pow(t[0]-o.peek(a).color[0],2)+Math.pow(t[1]-o.peek(a).color[1],2)+Math.pow(t[2]-o.peek(a).color[2],2)))||void 0===r)&&(r=e,n=o.peek(a).color);return n},forcebw:function(){var t=this.vboxes;t.sort((function(t,r){return n.naturalOrder(n.sum(t.color),n.sum(r.color))}));var r=t[0].color;r[0]<5&&r[1]<5&&r[2]<5&&(t[0].color=[0,0,0]);var e=t.length-1,o=t[e].color;o[0]>251&&o[1]>251&&o[2]>251&&(t[e].color=[255,255,255])}},{quantize:function(t,e){function c(t,r){for(var e,n=1,o=0;1e3>o;)if((e=t.pop()).count()){var a=s(u,e),i=a[0],c=a[1];if(!i)return;if(t.push(i),c&&(t.push(c),n++),n>=r)return;if(o++>1e3)return}else t.push(e),o++}if(!t.length||2>e||e>256)return!1;var u=a(t);u.forEach((function(){}));var l=i(t,u),d=new r((function(t,r){return n.naturalOrder(t.count(),r.count())}));d.push(l),c(d,.75*e);for(var p=new r((function(t,r){return n.naturalOrder(t.count()*t.volume(),r.count()*r.volume())}));d.size();)p.push(d.pop());c(p,e-p.size());for(var h=new o;p.size();)h.push(p.pop());return h}}}();t.exports=e},24:(t,r,e)=>{var n=e(735).default;function o(){"use strict";t.exports=o=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var r,e={},a=Object.prototype,i=a.hasOwnProperty,s=Object.defineProperty||function(t,r,e){t[r]=e.value},c="function"==typeof Symbol?Symbol:{},u=c.iterator||"@@iterator",l=c.asyncIterator||"@@asyncIterator",d=c.toStringTag||"@@toStringTag";function p(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{p({},"")}catch(r){p=function(t,r,e){return t[r]=e}}function h(t,r,e,n){var o=r&&r.prototype instanceof x?r:x,a=Object.create(o.prototype),i=new A(n||[]);return s(a,"_invoke",{value:C(t,e,i)}),a}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var m="suspendedStart",v="suspendedYield",y="executing",g="completed",b={};function x(){}function w(){}function _(){}var I={};p(I,u,(function(){return this}));var k=Object.getPrototypeOf,N=k&&k(k(L([])));N&&N!==a&&i.call(N,u)&&(I=N);var j=_.prototype=x.prototype=Object.create(I);function E(t){["next","throw","return"].forEach((function(r){p(t,r,(function(t){return this._invoke(r,t)}))}))}function D(t,r){function e(o,a,s,c){var u=f(t[o],t,a);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"==n(d)&&i.call(d,"__await")?r.resolve(d.__await).then((function(t){e("next",t,s,c)}),(function(t){e("throw",t,s,c)})):r.resolve(d).then((function(t){l.value=t,s(l)}),(function(t){return e("throw",t,s,c)}))}c(u.arg)}var o;s(this,"_invoke",{value:function(t,n){function a(){return new r((function(r,o){e(t,n,r,o)}))}return o=o?o.then(a,a):a()}})}function C(t,e,n){var o=m;return function(a,i){if(o===y)throw Error("Generator is already running");if(o===g){if("throw"===a)throw i;return{value:r,done:!0}}for(n.method=a,n.arg=i;;){var s=n.delegate;if(s){var c=O(s,n);if(c){if(c===b)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===m)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var u=f(t,e,n);if("normal"===u.type){if(o=n.done?g:v,u.arg===b)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=g,n.method="throw",n.arg=u.arg)}}}function O(t,e){var n=e.method,o=t.iterator[n];if(o===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=r,O(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;var a=f(o,t.iterator,e.arg);if("throw"===a.type)return e.method="throw",e.arg=a.arg,e.delegate=null,b;var i=a.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=r),e.delegate=null,b):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b)}function P(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function S(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function A(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function L(t){if(t||""===t){var e=t[u];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function e(){for(;++o<t.length;)if(i.call(t,o))return e.value=t[o],e.done=!1,e;return e.value=r,e.done=!0,e};return a.next=a}}throw new TypeError(n(t)+" is not iterable")}return w.prototype=_,s(j,"constructor",{value:_,configurable:!0}),s(_,"constructor",{value:w,configurable:!0}),w.displayName=p(_,d,"GeneratorFunction"),e.isGeneratorFunction=function(t){var r="function"==typeof t&&t.constructor;return!!r&&(r===w||"GeneratorFunction"===(r.displayName||r.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,p(t,d,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},E(D.prototype),p(D.prototype,l,(function(){return this})),e.AsyncIterator=D,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var i=new D(h(t,r,n,o),a);return e.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},E(j),p(j,d,"Generator"),p(j,u,(function(){return this})),p(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var r=Object(t),e=[];for(var n in r)e.push(n);return e.reverse(),function t(){for(;e.length;){var n=e.pop();if(n in r)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=L,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&i.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=r)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(n,o){return s.type="throw",s.arg=t,e.next=n,o&&(e.method="next",e.arg=r),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&i.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=r&&r<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=r,o?(this.method="next",this.next=o.finallyLoc,b):this.complete(a)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),b},finish:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),S(e),b}},catch:function(t){for(var r=this.tryEntries.length-1;r>=0;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n=e.completion;if("throw"===n.type){var o=n.arg;S(e)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:L(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=r),b}},e}t.exports=o,t.exports.__esModule=!0,t.exports.default=t.exports},735:t=>{function r(e){return t.exports=r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,r(e)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},183:(t,r,e)=>{var n=e(24)();t.exports=n;try{regeneratorRuntime=n}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}}},r={};function e(n){var o=r[n];if(void 0!==o)return o.exports;var a=r[n]={exports:{}};return t[n](a,a.exports,e),a.exports}e.n=t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},e.d=(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},e.o=(t,r)=>Object.prototype.hasOwnProperty.call(t,r),e.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};(()=>{"use strict";e.r(n),e.d(n,{extend:()=>Et});const t=flarum.core.compat["forum/app"];var r=e.n(t);function o(t,r,e,n,o,a,i){try{var s=t[a](i),c=s.value}catch(t){return void e(t)}s.done?r(c):Promise.resolve(c).then(n,o)}function a(t){return function(){var r=this,e=arguments;return new Promise((function(n,a){var i=t.apply(r,e);function s(t){o(i,n,a,s,c,"next",t)}function c(t){o(i,n,a,s,c,"throw",t)}s(void 0)}))}}var i=e(183),s=e.n(i),c=null,u=function(){function t(t){this.fetchIntervalId=-1,this.fetchId={},this.cb=[],this.app=void 0,c=this,this.app=t}var r=t.prototype;return r.done=function(t){this.cb.push(t)},t.getInstance=function(){return c},r.sendFetch=function(){var t=a(s().mark((function t(){var r,e,n=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.fetchIntervalId=-1,r=this.fetchId,e=Object.keys(r).map((function(t){return parseInt(t)})),this.fetchId={},t.next=6,this.app.store.find("user_decoration",{id:e});case 6:t.sent,e.forEach((function(t){r[t].forEach((function(r){r(n.app.store.getById("user-decorations",t+""))}))})),this.cb.forEach((function(t){t()}));case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.fetchStyle=function(t){var r=this;if(!t)return Promise.resolve(null);t=parseInt(t+"");var e=this.app.store.getById("user-decorations",t+"");return e?Promise.resolve(e):new Promise((function(e){r.fetchId[t]=r.fetchId[t]||[],r.fetchId[t].push(e),-1==r.fetchIntervalId&&(r.fetchIntervalId=setTimeout(r.sendFetch.bind(r),400))}))},r.fetchStyleSync=function(t){return this.app.store.getById("user-decorations",t+"")||void 0},r.getApp=function(){return this.app},t}();const l=flarum.core.compat["common/Component"];var d=e.n(l);const p=flarum.core.compat["common/extend"],h=flarum.core.compat["common/models/User"];var f=e.n(h);function v(t,r){var e,n;if(!t.decoration&&(t.decorationId&&(t.decoration=null==(e=u.getInstance())?void 0:e.fetchStyleSync(t.decorationId),t.decoration||null==(n=u.getInstance())||n.fetchStyle(t.decorationId).then((function(){$(r.element).addClass("user-decoration-hijack-wait-reload"),m.redraw()}))),!t.decoration))return;t.container&&k(t.container,t.decoration)}var y={},g={},b={};function x(t,r,e,n){b[t]||(b[t]={}),b[t][r]||(b[t][r]=!0,console.warn(e,n))}function w(t,r){var e,n;if(r instanceof RegExp){var o;if(r.test((null==(o=t.attrs)?void 0:o.className)||""))return!0}else{if("*"==r)return!0;if(((null==(e=t.attrs)?void 0:e.className)||"").includes(r))return!0;if(((null==(n=t.tag)?void 0:n.toString())||"").includes(r))return!0}return!1}function _(t,r,e,n){if(void 0===n&&(n=[]),"#"!=t.tag){var o=e;if(w(t,r[e])&&++o==r.length)return t;if("object"==typeof t.children&&"number"==typeof t.children.length)for(var a=0;a<t.children.length;a++)if(t.children[a]){var i,s=_(t.children[a],r,o,n);if(s)return null==(i=n)||i.unshift(a),s}return null}}function I(t,r,e,n){var o=null;if(g[r][e]&&(o=function(t,r,e){for(var n,o=t;void 0!==(n=r.shift());){if(!o.children||"object"!=typeof o.children||!o.children[n])return null;o=o.children[n]}return w(o,e)?o:null}(t,g[r][e],n),o||(g[r][e]=!1)),!o){var a=[];!1===g[r][e]?o=_(t,n,0,void 0):(o=_(t,n,0,a))&&(g[r][e]=a)}return o}function k(t,r){var e=r.id();if(!y[e]){var n=r.style();y[e]={};for(var o=n.matchAll(/\.(element-[^\[\{]*)((?:\[[a-zA-Z0-9]+=.+\])*)[^\[]/gi),a=o.next();!a.done;){var i=a.value,s=i[1],c=i[2],u={};if(c)for(var l=c.matchAll(/\[([a-zA-Z0-9]+)=([^\]]+)\]/gi),d=l.next();!d.done;){var p=d.value,h=p[1],f=p[2].trim();if(f.startsWith('"')&&f.endsWith('"')||f.startsWith("'")&&f.endsWith("'"))u[h]=f.slice(1,-1);else if(f.startsWith("/")&&f.includes("/",1)){var m=f.split("/");u[h]=new RegExp(m[1],m[2])}else u[h]=f;d=l.next()}u.tag&&"#"!=u.tag||(u.tag="span"),u.copy&&("string"==typeof u.copy?u.copy=u.copy.split(" "):u.copy=[u.copy]),u.parent&&("string"==typeof u.parent?u.parent=u.parent.split(" "):u.parent=[u.parent]),y[e][s]=u,a=o.next()}n=(n=n.replace(/(\.element-[^\[]*)(?:\[[a-zA-Z0-9]*=.*\])*([^\[])/gi,"$1$2")).replace(/\.base/g,".user-decoration-"+e);var v=$("<style>").attr("id","user-decoration-"+e);v.html(n),$("head").append(v)}g[e]||(g[e]={});var b=[];Object.keys(y[e]).forEach((function(r){var n,o=y[e][r],a=null;if(o.parent){if(!(a=I(t,e,r,o.parent)))return void x(e,r,"[DecorationApplier] Parent element is not found.",{createSpec:o,element:t})}else a=t;if(a.children&&"object"==typeof a.children&&"number"==typeof(null==(n=a.children)?void 0:n.length)){var i=null;if(o.copy){var s=I(t,e,r,o.copy);if(s&&(i=$.extend(!0,{},s)),!i)return void x(e,r,"[DecorationApplier] To copy element not found",{createSpec:o,element:t});o.class&&(i.attrs.className=(i.attrs.className||"")+" "+o.class),i.attrs.className=(i.attrs.className||"")+" "+r}else i={tag:o.tag,states:void 0,attrs:{className:(o.class||"")+" "+r,style:o.style||""},children:[{tag:"#",children:o.content||"",attrs:{},states:void 0}]};var c=t.children.length-1;if(o.after&&t.children)for(var u=0;u<t.children.length;u++)if(w(t.children[u],o.after)){c=u;break}b.push([a,c,i])}else x(e,r,"[DecorationApplier] Parent element is not a fragment.",{createSpec:o,parent:a,element:t})})),b.forEach((function(t){t[0].children.splice(t[1]+1,0,t[2])})),new RegExp("( |^)user-decoration-"+e+"( |$)").test(t.attrs.className)||(t.attrs.className+=" user-decoration-"+e),/( |^)has-user-decoration( |$)/.test(t.attrs.className)||(t.attrs.className+=" has-user-decoration")}const N=flarum.core.compat["common/utils/computed"];var j=e.n(N);const E=flarum.core.compat["common/utils/stringToColor"];var D=e.n(E),C=e(946),O=e.n(C);const P=flarum.core.compat["forum/components/Post"];var S=e.n(P);const A=flarum.core.compat["forum/components/UserCard"];var L=e.n(A),B=function(){function t(t,r,e,n){this.states=void 0,this.attrs=void 0,this.element=void 0,this.tag=void 0,this.children=void 0,this.stringRet=void 0,this.data=void 0,this.stringRet=r,this.states=t.states,this.attrs=t.attrs,this.element=t.element,this.tag=t.tag,this.children=[{tag:"span",attrs:{class:n},states:void 0,children:[{tag:"#",children:r,attrs:{},states:void 0}]}],this.data=e}return t.prototype.toString=function(){return this.stringRet},t}(),U=0;function T(){var t;return null==(t=u.getInstance())||null==(t=t.getApp().forum)?void 0:t.attribute("username_hijack")}function M(){var t;return null==(t=u.getInstance())||null==(t=t.getApp().forum)?void 0:t.attribute("avatar_hijack")}function F(){var t=f().prototype.avatarUrl;f().prototype.realAvatarUrl=t,f().prototype.hijackColor=function(){var t=this;return j()("displayName","realAvatarUrl","avatarColor",(function(r,e,n){return n?"rgb("+n.join(", ")+")":e?(function(t,r){var e=new Image;e.addEventListener("load",(function(){try{var r=new(O());t.avatarColor=r.getColor(this)}catch(r){if(!(r instanceof TypeError))throw r;t.avatarColor=[255,255,255]}t.freshness=new Date,m.redraw()})),e.crossOrigin="anonymous",e.src=null!=r?r:""}(t,e),""):"#"+D()(r)})).call(this)},(0,p.override)(f().prototype,"avatarUrl",(function(){var r;if(!M())return t.call(this);var e=this.hijackColor();e&&e.charAt&&(e=e.replace(/#/g,"@"));var n=JSON.stringify({decorationId:null==(r=this.data.attributes)?void 0:r.avatar_decoration,username:this.username(),displayName:this.realDisplayName(),id:this.id(),color:e});return(t.call(this)||"").split("#").pop()+"#"+n}));var r=f().prototype.username;f().prototype.realUserName=r,f().prototype.realDisplayName=f().prototype.displayName,(0,p.override)(f().prototype,"displayName",(function(t){return T()?new B({tag:"span",attrs:{className:"username-container",user:this}},t(),{user:this},"username-text"):t()})),(0,p.extend)(d().prototype,["oninit"],(function(){(T()||M())&&(this.userDecorationHijackIid=U++,this.originalView=this.view.bind(this),this.view=R.bind(this),this.originalOnBefUp=this.onbeforeupdate.bind(this),this.onbeforeupdate=z.bind(this))})),(0,p.extend)(d().prototype,["onupdate","oncreate"],a(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:$(".decoration-container").each((function(t,r){var e=$(r);e.length&&!["absolute","fixed","relative"].includes(window.getComputedStyle(e[0]).position)&&e.css("position","relative"),!e.length||e.hasClass("Post")||e.hasClass("UserCard")||"auto"!==window.getComputedStyle(e[0]).zIndex||e.css("z-index","0")}));case 2:case"end":return t.stop()}}),t)})))),console.log("Decoration Hijack loaded")}function z(){var t=0!==this.$(".user-decoration-hijack-wait-reload").length||$(this.element).hasClass("user-decoration-hijack-wait-reload");$(this.element).removeClass("user-decoration-hijack-wait-reload");for(var r=arguments.length,e=new Array(r),n=0;n<r;n++)e[n]=arguments[n];if(!1===this.originalOnBefUp.apply(this,e)){if(t)return;return!1}}function R(t){var r=this.originalView(t);return r?q(r)?G(r,this):(H(null,r,t,this),r):r}function H(t,r,e,n){var o;r!==e&&(t&&q(r)?t.children=t.children.map((function(t){return t===r?G(t,n):t})):t&&(o=r)&&o instanceof B&&"username-container"==o.attrs.className?function(t,r){var e=t.data.user;v({decorationId:e.attribute("name_decoration"),username:e.attribute("username"),container:t},r)}(r,n):"object"==typeof r.children&&r.children.forEach&&r.children.forEach((function(t){t&&H(r,t,e,n)})))}function q(t){var r;return t&&"img"==t.tag&&(null==(r=t.attrs.className)?void 0:r.includes("Avatar"))&&/( |^)Avatar( |$)/.test(t.attrs.className)&&t.attrs.src}function G(t,r){var e,n=t.attrs.src.split("#");if(2!=n.length)return t;var o=t,a=JSON.parse(n.pop()),i=n.shift();if(!i){var s;o.tag="span",o.children=[{tag:"#",children:null==(s=a.username)?void 0:s.charAt(0),state:void 0,attrs:{}}];var c,u=a.color;u&&u.charAt&&(u=u.replace(/@/g,"#")),u&&(o.attrs.style=(null!=(c=o.attrs.style)?c:"")+";--avatar-bg: "+u+";")}o.attrs.src=i;var l,d={tag:"span",attrs:{"data-ctr":"avatar"},state:void 0,children:[o]};return d.attrs.style=o.attrs.style,d.attrs.className=(null!=(e=o.attrs.className)?e:"")+" Avatar-container decoration-container",d.attrs["data-userDecorationHijackIid"]=r.userDecorationHijackIid,r.appendRelative&&(d.attrs.style=(null!=(l=d.attrs.style)?l:"")+";position:relative;"),o.attrs.className="",a.container=d,v(a,r),d}const W=flarum.core.compat["forum/components/UserPage"];var V=e.n(W);const Z=flarum.core.compat["common/components/LinkButton"];var J=e.n(Z);function Y(t,r){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},Y(t,r)}function K(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,Y(t,r)}const Q=flarum.core.compat["common/components/LoadingIndicator"];var X=e.n(Q);const tt=flarum.core.compat["common/components/Button"];var rt=e.n(tt);const et=flarum.core.compat["common/components/Modal"];var nt=e.n(et);const ot=flarum.core.compat["common/components/Select"];var at=e.n(ot);const it=flarum.core.compat["common/utils/setRouteWithForcedRefresh"];var st=e.n(it),ct=function(t){function e(){for(var r,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(r=t.call.apply(t,[this].concat(n))||this).loading=!1,r.decorationId="",r.decoration=null,r}K(e,t);var n=e.prototype;return n.className=function(){return"Modal--small"},n.title=function(){return this.attrs.decoration_id?r().translator.trans("xypp-user-decoration.forum.create-modal.edit-title",[this.attrs.decoration_id]):r().translator.trans("xypp-user-decoration.forum.create-modal.title")},n.content=function(){return m("div",{className:"Modal-body"},m("div",{className:"Form"},m("div",{className:"Form-group"},m("label",{for:"xypp-user-decoration-create-ipt-type"},r().translator.trans("xypp-user-decoration.forum.create-modal.type.title")),m(at(),{id:"xypp-user-decoration-create-ipt-type",options:{avatar:r().translator.trans("xypp-user-decoration.forum.create-modal.type.avatar"),name:r().translator.trans("xypp-user-decoration.forum.create-modal.type.username"),card:r().translator.trans("xypp-user-decoration.forum.create-modal.type.usercard"),post:r().translator.trans("xypp-user-decoration.forum.create-modal.type.post")}})),m("div",{className:"Form-group"},m("label",{for:"xypp-user-decoration-create-ipt-name"},r().translator.trans("xypp-user-decoration.forum.create-modal.name")),m("input",{id:"xypp-user-decoration-create-ipt-name",required:!0,className:"FormControl",step:"any"})),m("div",{className:"Form-group"},m("label",{for:"xypp-user-decoration-create-ipt-desc"},r().translator.trans("xypp-user-decoration.forum.create-modal.desc")),m("textarea",{id:"xypp-user-decoration-create-ipt-desc",required:!0,className:"FormControl",step:"any"})),m("p",null,r().translator.trans("xypp-user-decoration.forum.create-modal.tip")),m("div",{className:"Form-group"},m("label",{for:"xypp-user-decoration-create-ipt-style"},r().translator.trans("xypp-user-decoration.forum.create-modal.style")),m("textarea",{id:"xypp-user-decoration-create-ipt-style",required:!0,className:"FormControl",step:"any"})),m("div",{className:"Form-group"},m(rt(),{class:"Button Button--primary",type:"submit",loading:this.loading,disabled:this.loading},this.attrs.decoration_id?r().translator.trans("xypp-user-decoration.forum.create-modal.edit-button"):r().translator.trans("xypp-user-decoration.forum.create-modal.button")),this.attrs.decoration_id?m(J(),{loading:this.loading,disabled:this.loading,onclick:this.delete.bind(this)},m("i",{class:"fas fa-trash"}),r().translator.trans("xypp-user-decoration.forum.create-modal.delete-button")):"")))},n.onready=function(){var t,r=this;this.decorationId=this.attrs.decoration_id,this.decorationId&&(this.loading=!0,null==(t=u.getInstance())||t.fetchStyle(this.decorationId).then((function(t){r.decoration=t,r.loading=!1,r.$("#xypp-user-decoration-create-ipt-name").val(t.name()),r.$("#xypp-user-decoration-create-ipt-desc").val(t.desc()),r.$("#xypp-user-decoration-create-ipt-style").val(t.style()),r.$("#xypp-user-decoration-create-ipt-type").val(t.type()),m.redraw()})))},n.onsubmit=function(){var t=a(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),this.loading=!0,t.prev=2,t.next=5,r().request({url:r().forum.attribute("apiUrl")+"/user_decoration",method:"POST",body:{attributes:{id:this.decorationId,style:this.$("#xypp-user-decoration-create-ipt-style").val(),desc:this.$("#xypp-user-decoration-create-ipt-desc").val(),name:this.$("#xypp-user-decoration-create-ipt-name").val(),type:this.$("#xypp-user-decoration-create-ipt-type").val()}}});case 5:r().modal.close(),r().alerts.show({type:"success"},r().translator.trans("xypp-user-decoration.forum.create-success")),st()(r().route("user.user_own_decoration",{username:r().current.get("user").attribute("slug")})),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(2),this.loading=!1;case 13:case"end":return t.stop()}}),t,this,[[2,10]])})));return function(r){return t.apply(this,arguments)}}(),n.delete=function(){var t=a(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(confirm(r().translator.trans("xypp-user-decoration.forum.delete_confirm"))){t.next=2;break}return t.abrupt("return");case 2:return this.loading=!0,t.prev=3,t.next=6,r().request({url:r().forum.attribute("apiUrl")+"/user_decoration/"+this.attrs.decoration_id+"/delete",method:"GET"});case 6:r().modal.close(),r().alerts.show({type:"success"},r().translator.trans("xypp-user-decoration.forum.delete-success")),st()(r().route("user.user_own_decoration",{username:r().current.get("user").attribute("slug")})),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),this.loading=!1;case 14:case"end":return t.stop()}}),t,this,[[3,11]])})));return function(){return t.apply(this,arguments)}}(),e}(nt());const ut=flarum.core.compat["common/helpers/avatar"];var lt=e.n(ut);const dt=flarum.core.compat["common/helpers/username"];var pt=e.n(dt);function ht(t,r,e){return t?r:e||""}var ft=function(t){function e(){for(var r,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(r=t.call.apply(t,[this].concat(n))||this).type="",r.id=0,r.isCurrent=!1,r.uodId=0,r.decoration=null,r.changing=!1,r}K(e,t);var n=e.prototype;return n.oninit=function(r){t.prototype.oninit.call(this,r)},n.oncreate=function(r){t.prototype.oncreate.call(this,r)},n.onupdate=function(r){t.prototype.onupdate.call(this,r)},n.change=function(){var t=a(s().mark((function t(){var e;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.changing=!0,m.redraw(),e={},this.isCurrent?e[this.type+"_decoration"]="null":e[this.type+"_decoration"]=this.decoration.id(),t.next=6,r().session.user.save(e);case 6:this.changing=!1,m.redraw();case 8:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.view=function(){var t,e,n;this.id=this.attrs.decoration_id,this.type=this.attrs.type,this.uodId=this.attrs.user_own_decoration_id,["avatar","name","card","post"].includes(this.type)||(this.type="error");var o,a,i=m("div",{class:"error"},r().translator.trans("xypp-user-decoration.forum.decoration-box.error")),s={id:parseInt(r().session.user.id()||""),username:r().session.user.username(),decorationId:this.id,color:r().session.user.hijackColor().replace(/\#/g,"@")};if(this.decoration=r().store.getById("user-decorations",s.decorationId+""),this.decoration||null==(o=u.getInstance())||o.fetchStyle(this.id).then((function(){return m.redraw()})),this.changing)i=m(X(),null);else if("avatar"==this.type){var c;i=r().forum.attribute("username_hijack")?m("img",{title:"-",class:"Avatar",src:((null==(c=r().session.user)?void 0:c.realAvatarUrl())||"")+"#"+JSON.stringify(s)}):r().translator.trans("xypp-user-decoration.forum.decoration-box.closed")}else if("name"==this.type){var l;r().forum.attribute("username_hijack")?(i=m("span",{class:"username-container username"},m("span",{class:"username-text"},null==(l=r().session.user)?void 0:l.realUserName())),this.decoration&&k(i,this.decoration)):i=r().translator.trans("xypp-user-decoration.forum.decoration-box.closed")}else if("card"==this.type){var d;i=m("div",{class:"decoration-box-card-container"},m(L(),{user:r().session.user,controlsButtonClassName:"UserCard-controls App-primaryControl",className:"UserCard--popover in",decoration_id:null==(d=this.decoration)?void 0:d.id()}))}else if("post"==this.type){var p=(a=r().session.user,m("div",{class:"PostStream-item","data-index":"0","data-time":"2024-06-27T15:05:51.000Z","data-number":"1","data-id":"1","data-type":"comment"},m("article",{class:"CommentPost Post Post--by-actor Post--by-start-user"},m("div",null,m("header",{class:"Post-header"},m("ul",null,m("li",{class:"item-user"},m("div",{class:"PostUser"},m("h3",{class:"PostUser-name"},m("a",null,lt()(a),m("span",{class:"UserOnline"}),pt()(a))))))),m("aside",{class:"Post-actions"},m("ul",null,m("li",null,m("div",{class:"ButtonGroup Dropdown dropdown Post-controls itemCount3"},m("button",{class:"Dropdown-toggle Button Button--icon Button--flat","aria-haspopup":"menu","aria-label":"Toggle post controls dropdown menu","data-toggle":"dropdown"},m("i",{"aria-hidden":"true",class:"icon fas fa-ellipsis-h Button-icon"}))))))))));this.decoration&&k(p,this.decoration),i=m("div",{class:"decoration-box-card-container"},p)}return this.isCurrent=this.decoration&&(null==(t=r().session.user)?void 0:t.attribute(this.type+"_decoration"))==(null==(e=this.decoration)?void 0:e.id()),m("div",{className:"DecorationBox"},m("div",{className:"decoration-head"},m("div",{className:"decoration-name"},null==(n=this.decoration)?void 0:n.name()),m("div",{className:"decoration-type"},r().translator.trans("xypp-user-decoration.forum.decoration-box."+this.type))),m("div",{className:"prev-warpper"},i),m("div",{class:"decoration-box-content"},this.decoration?this.decoration.desc():r().translator.trans("xypp-user-decoration.forum.decoration-box.loading")),ht(!this.attrs.noBtn,m(rt(),{class:"Button Button--primary",loading:this.changing,disabled:this.changing,onclick:this.change.bind(this)},this.isCurrent?r().translator.trans("xypp-user-decoration.forum.decoration.remove_button"):r().translator.trans("xypp-user-decoration.forum.decoration.change_button"))),ht(!(this.attrs.noDelete||!this.uodId),m("div",{class:"delete-decoration",onclick:this.delete.bind(this)},m("i",{class:"fas fa-times","aria-label":r().translator.trans("xypp-user-decoration.forum.decoration.delete_button")}))),ht(!this.attrs.noEdit,m("div",{class:"edit-decoration",onclick:this.edit.bind(this)},m("i",{class:"fas fa-edit","aria-label":r().translator.trans("xypp-user-decoration.forum.decoration.edit_button")}))))},n.delete=function(){var t=a(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!confirm(r().translator.trans("xypp-user-decoration.forum.decoration.delete_confirm"))){t.next=6;break}return this.changing=!0,t.next=4,r().request({url:r().forum.attribute("apiUrl")+"/user-own-decoration/"+this.uodId+"/delete"});case 4:this.changing=!1,st()(r().route("user.user_own_decoration",{username:r().current.get("user").attribute("slug")}));case 6:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.edit=function(){r().modal.show(ct,{decoration_id:this.decoration.id()})},e}(d());const mt=flarum.core.compat["common/components/Placeholder"];var vt=e.n(mt),yt=function(t){function e(){for(var r,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(r=t.call.apply(t,[this].concat(n))||this).loading=!1,r.record=null,r}K(e,t);var n=e.prototype;return n.oninit=function(r){t.prototype.oninit.call(this,r),this.loadUser(m.route.param("username"))},n.oncreate=function(t){},n.onupdate=function(t){},n.show=function(r){t.prototype.show.call(this,r),this.loadData()},n.content=function(){var t,e,n=this;return m("div",{className:"decoration-page-container"},m("div",{class:"decoration-page-title"},m("h3",null,r().translator.trans("xypp-user-decoration.forum.decorations")),r().session.user.canCreateDecoration()?m(rt(),{class:"Button Button--primary",onclick:this.create.bind(this)},m("i",{class:"fas fa-plus"}),m("span",null,r().translator.trans("xypp-user-decoration.forum.create"))):""),m("div",{className:"decoration-page"},ht(this.loading,m(X(),{display:"block"}),ht(!(null==(t=this.record)||!t.length),null==(e=this.record)?void 0:e.map((function(t,e){var o,a,i;return m(ft,{type:t.decoration_type(),user_own_decoration_id:!t.attribute("fake")&&t.id(),decoration_id:t.decoration_id(),noBtn:(null==(o=n.user)?void 0:o.id())!=(null==(a=r().session.user)?void 0:a.id()),noDelete:!(null!=(i=r().session.user)&&i.canDeleteDecoration()),noEdit:!r().session.user.canCreateDecoration()})})),m(vt(),{text:r().translator.trans("xypp-user-decoration.forum.decoration-no-available")})))))},n.loadData=function(){var t=a(s().mark((function t(){var e,n,o,a;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==this.record){t.next=2;break}return t.abrupt("return");case 2:if(null!=(e=this.user)&&e.id()){t.next=4;break}return t.abrupt("return");case 4:if(!this.loading){t.next=6;break}return t.abrupt("return");case 6:return this.loading=!0,r().store.all("user-own-decoration").forEach((function(t){r().store.remove(t)})),m.redraw(),t.next=11,r().request({url:r().forum.attribute("apiUrl")+"/user-own-decoration?id="+(null==(n=this.user)?void 0:n.id()),method:"GET"});case 11:o=t.sent,a=1,o.data.forEach((function(t){return a=Math.max(a,t.id||0)})),o.data.forEach((function(t){t.attributes.fake=!t.id,t.id=t.id||++a})),this.record=r().store.pushPayload(o),this.loading=!1,m.redraw();case 18:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),n.create=function(){r().modal.show(ct)},e}(V()),gt=function(t){function e(){for(var r,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(r=t.call.apply(t,[this].concat(n))||this).loading=!0,r.records={},r.value=0,r.decorationBox=null,r.decorationType="",r.decorationId="",r}K(e,t);var n=e.prototype;return n.className=function(){return"Modal--small"},n.title=function(){return r().translator.trans("xypp-user-decoration.forum.modal.title")},n.content=function(){var t=this;return m("div",{className:"Modal-body"},m("p",null,r().translator.trans("xypp-user-decoration.forum.modal.tip")),m(at(),{options:this.records,value:this.value,onchange:this.change.bind(this)}),m(ft,{noBtn:!0,oncreate:function(r){return t.decorationBox=r},decoration_id:t.decorationId,type:t.decorationType}),m("div",{className:"paymodal-btn"},m(rt(),{class:"Button Button--primary",loading:this.loading,disabled:this.loading,onclick:this.offer.bind(this)},r().translator.trans("xypp-user-decoration.forum.modal.button"))))},n.onready=function(){var t=this;this.loading=!0,r().store.find("user_decoration_all").then((function(){t.records={},r().store.all("user-decorations").forEach((function(e){t.records[parseInt(e.id())]="["+r().translator.trans("xypp-user-decoration.forum.decoration-box."+e.attribute("type"))+"]"+e.attribute("name")+":"+e.attribute("desc")})),t.loading=!1,m.redraw()}))},n.offer=function(){var t=a(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loading=!0,t.prev=1,t.next=4,r().request({url:r().forum.attribute("apiUrl")+"/user-own-decoration",method:"POST",body:{attributes:{user_id:this.attrs.user_id,decoration_id:this.decorationId}}});case 4:r().modal.close(),st()(r().route("user.user_own_decoration",{username:r().current.get("user").attribute("slug")})),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),this.loading=!1;case 11:case"end":return t.stop()}}),t,this,[[1,8]])})));return function(){return t.apply(this,arguments)}}(),n.change=function(t){this.value=t;var e=r().store.getById("user-decorations",t);this.decorationType=e.type(),this.decorationId=e.id(),m.redraw()},e}(nt());const bt=flarum.core.compat["forum/utils/UserControls"];var xt=e.n(bt);const wt=flarum.core.compat["common/Model"];var _t=e.n(wt);r().initializers.add("xypp/user-decoration",(function(){var t;f().prototype.canOfferDecoration=_t().attribute("canOfferDecoration"),f().prototype.canViewDecoration=_t().attribute("canViewDecoration"),f().prototype.canCreateDecoration=_t().attribute("canCreateDecoration"),f().prototype.canDeleteDecoration=_t().attribute("canDeleteDecoration"),new u(r()),F(),(0,p.override)(S().prototype,"view",(function(t){this.userDecorationHijackIid=this.userDecorationHijackIid||U++;for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];var o=t(e);o.attrs["data-userDecorationHijackIid"]=this.userDecorationHijackIid,o.attrs.className=(o.attrs.className||"")+" decoration-container";var a=this.attrs.post.user(),i={username:a.realUserName(),container:o,id:a.id(),decorationId:a.attribute("post_decoration")};return this.attrs.decoration_id&&(i.decorationId=this.attrs.decoration_id),v(i,this),o})),(0,p.override)(L().prototype,"view",(function(t){this.userDecorationHijackIid=this.userDecorationHijackIid||U++;for(var r=arguments.length,e=new Array(r>1?r-1:0),n=1;n<r;n++)e[n-1]=arguments[n];var o=t(e);o.attrs["data-userDecorationHijackIid"]=this.userDecorationHijackIid,o.attrs.className=(o.attrs.className||"")+" decoration-container";var a=this.attrs.user,i={username:a.realUserName(),container:o,id:a.id(),decorationId:a.attribute("card_decoration")};return this.attrs.decoration_id&&(i.decorationId=this.attrs.decoration_id),v(i,this),o})),r().routes["user.user_own_decoration"]={path:"/u/:username/user_own_decoration",component:yt},(0,p.extend)(V().prototype,"navItems",(function(t){var e;r().session.user&&t.add("user_own_decoration",J().component({href:r().route("user.user_own_decoration",{username:null==(e=this.user)?void 0:e.username()}),icon:"fas fa-receipt"},[r().translator.trans("xypp-user-decoration.forum.page.show-decorations")]),10)})),(0,p.extend)(xt(),"moderationControls",(function(t,e){var n;null!=(n=r().session.user)&&n.canOfferDecoration()&&t.add("offer-decoration",rt().component({icon:"fas fa-money-bill",onclick:function(){return r().modal.show(gt,{user_id:e.id()})}},r().translator.trans("xypp-user-decoration.forum.user_controls.offer")))})),"xypp-store"in flarum.extensions&&(t=r(),flarum.extensions["xypp-store"].addFrontendProviders("decoration",t.translator.trans("xypp-store.forum.create-modal.providers.decoration"),function(){var r=a(s().mark((function r(e){return s().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t.store.find("user_decoration_all");case 2:t.store.all("user-decorations").forEach((function(r){e[parseInt(r.id())]="["+t.translator.trans("xypp-user-decoration.forum.decoration-box."+r.attribute("type"))+"]"+r.attribute("name")+":"+r.attribute("desc")}));case 3:case"end":return r.stop()}}),r)})));return function(t){return r.apply(this,arguments)}}(),(function(r){var e=r.itemData();return m("div",{class:"decoration-ShowCase"},ht(!!t.session.user,m(ft,{decoration_id:e.id,type:e.type,noBtn:!0,noDelete:!0,noEdit:!0}),m(vt(),{text:t.translator.trans("xypp-user-decoration.forum.decoration-box.no-login")})))}),function(){var t=a(s().mark((function t(r){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","");case 1:case"end":return t.stop()}}),t)})));return function(r){return t.apply(this,arguments)}}()))}));const It=flarum.core.compat["common/extenders"];var kt=e.n(It),Nt=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(r=t.call.apply(t,[this].concat(n))||this).style=_t().attribute("style"),r.type=_t().attribute("type"),r.createdAt=_t().attribute("createdAt",_t().transformDate),r.name=_t().attribute("name"),r.desc=_t().attribute("desc"),r}return K(r,t),r}(_t()),jt=function(t){function r(){for(var r,e=arguments.length,n=new Array(e),o=0;o<e;o++)n[o]=arguments[o];return(r=t.call.apply(t,[this].concat(n))||this).user_id=_t().attribute("user_id"),r.decoration_id=_t().attribute("decoration_id"),r.decoration_type=_t().attribute("type"),r}return K(r,t),r}(_t());const Et=[(new(kt().Store)).add("user-decorations",Nt),(new(kt().Store)).add("user-own-decoration",jt),new(kt().Model)(f()).attribute("avatar_decoration")]})(),module.exports=n})();
//# sourceMappingURL=forum.js.map